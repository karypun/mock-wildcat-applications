"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.headersAuth = void 0;
const valueFromHeader = (header) => (Array.isArray(header)
    ? header[0]
    : header);
exports.headersAuth = ({ groupsHeader = 'x-auth-groups', rolesHeader = 'x-auth-roles', usernameHeader = 'x-auth-username' }) => ({
    extractor: (req) => {
        const username = valueFromHeader(req.headers[usernameHeader]);
        const groups = valueFromHeader(req.headers[groupsHeader]);
        const roles = valueFromHeader(req.headers[rolesHeader]);
        return (username && roles
            ? {
                username: username,
                groups: groups.split(',') || [],
                roles: roles.split(',') || []
            }
            : undefined);
    }
});
exports.default = exports.headersAuth;
