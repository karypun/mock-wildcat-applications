"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Fork = void 0;
const react_1 = require("react");
const context_1 = require("./context");
const registry_1 = require("./registry");
const graph_1 = require("./graph");
exports.Fork = props => {
    const form = context_1.useForm();
    const state = form.completion.pop();
    const active = state && state.active;
    if (active === undefined) {
        const left = new graph_1.Graph();
        const right = new graph_1.Graph();
        const node = new graph_1.ForkNode(props.if, left, right);
        form.registry.register(node);
        const leftRegister = new registry_1.Register(left);
        const rightRegister = new registry_1.Register(right);
        leftRegister.openRegistration();
        rightRegister.openRegistration();
        return react_1.createElement(react_1.Fragment, {
            children: [
                react_1.createElement(registry_1.Registry, {
                    children: props.then,
                    value: leftRegister
                }),
                react_1.createElement(registry_1.Registry, {
                    children: props.else,
                    value: rightRegister
                })
            ]
        });
    }
    else {
        return (active
            ? props.then || null
            : props.else || null);
    }
};
exports.default = exports.Fork;
